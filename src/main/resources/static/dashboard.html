<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>
        <span class="cn">åˆ›ä½œä¸­å¿ƒ - Twieeetter</span>
        <span class="en">Creator Center - Twieeetter</span>
    </title>
    <!-- å¼•å…¥é€šç”¨è¯­è¨€ç»„ä»¶CSS -->
    <link rel="stylesheet" href="common/lang-component.css">
    <style>
        /* å…¨å±€å¸ƒå±€ CSS */
        body { margin: 0; font-family: 'Segoe UI', Arial, sans-serif; background-color: #f4f5f7; display: flex; height: 100vh; overflow: hidden; }

        /* å·¦ä¾§ä¾§è¾¹æ  */
        .sidebar { width: 240px; background: white; border-right: 1px solid #e7e7e7; display: flex; flex-direction: column; padding-top: 20px; flex-shrink: 0; }
        .logo-area { padding: 0 24px 20px; font-size: 20px; font-weight: 900; color: #00a1d6; border-bottom: 1px solid #eee; margin-bottom: 20px; display: flex; align-items: center; gap: 10px; text-decoration: none; }
        /* å¤§å¤§çš„æŠ•ç¨¿æŒ‰é’® */
        .post-btn-container { padding: 0 20px; margin-bottom: 20px; }
        .big-post-btn { width: 100%; background-color: #00a1d6; color: white; border: none; padding: 12px; border-radius: 4px; font-size: 16px; cursor: pointer; display: flex; justify-content: center; align-items: center; font-weight: bold; text-decoration: none; box-sizing: border-box;}
        .big-post-btn:hover { background-color: #00b5e5; }

        /* èœå•é¡¹ */
        .menu-item { padding: 12px 24px; color: #505050; text-decoration: none; font-size: 15px; display: flex; align-items: center; transition: background 0.2s; }
        .menu-item:hover { background-color: #f4f5f7; color: #00a1d6; }
        .menu-item.active { color: #00a1d6; background-color: #eefaff; border-left: 3px solid #00a1d6; }
        .menu-icon { margin-right: 10px; font-size: 18px; width: 20px; text-align: center;}

        /* å³ä¾§ä¸»å†…å®¹åŒº */
        .main-content { flex: 1; padding: 30px; overflow-y: auto; }

        /* é¡¶éƒ¨ä¸ªäººæ  */
        .header { display: flex; justify-content: flex-end; align-items: center; margin-bottom: 30px; }
        .user-profile { display: flex; align-items: center; gap: 10px; cursor: pointer; }
        .avatar-small { width: 36px; height: 36px; border-radius: 50%; object-fit: cover; border: 1px solid #eee;}
        .username { font-weight: bold; color: #333; font-size: 14px; }

        /* === æ•°æ®å¡ç‰‡åŒºåŸŸ (ä»¿Bç«™) === */
        .section-title { font-size: 18px; font-weight: bold; color: #222; margin-bottom: 15px; border-left: 4px solid #00a1d6; padding-left: 10px; }

        .data-cards { display: flex; gap: 20px; margin-bottom: 30px; }
        .card { background: white; flex: 1; padding: 25px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.04); display: flex; flex-direction: column; }
        .card-label { color: #999; font-size: 14px; margin-bottom: 10px; }
        .card-value { font-size: 32px; font-weight: bold; color: #222; }
        .card-value.highlight { color: #00a1d6; }

        .welcome-banner { background: linear-gradient(90deg, #00a1d6, #5cdbd3); color: white; padding: 30px; border-radius: 8px; margin-bottom: 30px; display: flex; align-items: center; justify-content: space-between;}
        .welcome-text h2 { margin: 0 0 10px 0; }
        .welcome-text p { margin: 0; opacity: 0.9; }
    </style>
</head>
<body>

<!-- ä¾§è¾¹æ  -->
<div class="sidebar">
    <a href="index.html" class="logo-area">ğŸ“
        <span class="cn">åˆ›ä½œä¸­å¿ƒ</span>
        <span class="en">Creator Center</span>
    </a>

    <div class="post-btn-container">
        <a href="publish.html" class="big-post-btn">ğŸ“
            <span class="cn">å‘å¸ƒæ–°ç ”ç©¶</span>
            <span class="en">Publish New Research</span>
        </a>
    </div>

    <a href="dashboard.html" class="menu-item active">
        <span class="menu-icon">ğŸ </span>
        <span class="cn">é¦–é¡µæ¦‚è§ˆ</span>
        <span class="en">Home Overview</span>
    </a>
    <a href="content.html" class="menu-item">
        <span class="menu-icon">ğŸ“‚</span>
        <span class="cn">ç¨¿ä»¶ç®¡ç†</span>
        <span class="en">Manuscript Management</span>
    </a>
    <a href="index.html" class="menu-item">
        <span class="menu-icon">ğŸŒ</span>
        <span class="cn">è¿”å›å¹¿åœº</span>
        <span class="en">Return to Plaza</span>
    </a>
</div>

<!-- å³ä¾§å†…å®¹åŒº -->
<div class="main-content">
    <div class="header">
        <div class="user-profile">
            <img id="headerAvatar" src="https://via.placeholder.com/36" class="avatar-small">
            <span id="headerName" class="username">
                <span class="cn">åŠ è½½ä¸­...</span>
                <span class="en">Loading...</span>
            </span>
            <a href="#" onclick="logout()" style="font-size: 12px; color: #999; margin-left: 10px; text-decoration: none;">
                <span class="cn">[é€€å‡º]</span>
                <span class="en">[Logout]</span>
            </a>
        </div>
    </div>

    <!-- æ¬¢è¿æ¨ªå¹… -->
    <div class="welcome-banner">
        <div class="welcome-text">
            <h2 id="welcomeTitle">
                <span class="cn">ä½ å¥½ï¼UPä¸»</span>
                <span class="en">Hello! Creator</span>
            </h2>
            <p>
                <span class="cn">åˆ†äº«ä½ çš„å­¦æœ¯æˆæœå§ã€‚</span>
                <span class="en">Share your academic achievements.</span>
            </p>
        </div>
        <div style="font-size: 60px; opacity: 0.5;">ğŸ“</div>
    </div>

    <!-- æ ¸å¿ƒæ•°æ®å±•ç¤º -->
    <div class="section-title">
        <span class="cn">æ ¸å¿ƒæ•°æ®</span>
        <span class="en">Core Data</span>
    </div>
    <div class="data-cards">
        <div class="card">
            <span class="card-label">
                <span class="cn">ğŸ‘¥ ç²‰ä¸æ€»æ•°</span>
                <span class="en">ğŸ‘¥ Follower Count</span>
            </span>
            <span class="card-value" id="followerCount">--</span>
        </div>
        <div class="card">
            <span class="card-label">
                <span class="cn">ğŸ“„ å·²å‘ç ”ç©¶ (æ¨æ–‡)</span>
                <span class="en">ğŸ“„ Published Research (Posts)</span>
            </span>
            <span class="card-value highlight" id="tweetCount">--</span>
        </div>
        <div class="card">
            <span class="card-label">
                <span class="cn">ğŸ‘€ æ­£åœ¨å…³æ³¨</span>
                <span class="en">ğŸ‘€ Following Count</span>
            </span>
            <span class="card-value" id="followingCount">--</span>
        </div>
    </div>

    <div class="section-title">
        <span class="cn">ç³»ç»Ÿå…¬å‘Š</span>
        <span class="en">System Announcement</span>
    </div>
    <div style="background:white; padding:20px; border-radius:8px; color:#666;">
        <p>â€¢ <span class="cn">æ¬¢è¿ä½¿ç”¨ Twieeetter å­¦æœ¯ç‰ˆåˆ›ä½œä¸­å¿ƒï¼</span><span class="en">Welcome to Twieeetter Academic Creator Center!</span></p>
        <p>â€¢ <span class="cn">è¯·å„ä½ç ”ç©¶äººå‘˜éµå®ˆå­¦æœ¯è§„èŒƒï¼Œæ–‡æ˜äº¤æµã€‚</span><span class="en">Please abide by academic norms and communicate civilly.</span></p>
        <p>â€¢ <span class="cn">æ”¯æŒä¸Šä¼  PDF å’Œ Word æ–‡æ¡£ã€‚</span><span class="en">Supports uploading PDF and Word documents.</span></p>
    </div>
</div>

<!-- é€šç”¨è¯­è¨€åˆ‡æ¢ç»„ä»¶HTML -->
<div class="lang-selector" id="langSelector">
    <button class="lang-trigger" id="langTrigger">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 21l5.25-11.25L21 21m-9-3h7.5M3 10.5h7.5M13.5 3H3v7.5" />
        </svg>
    </button>
    <div class="lang-dropdown">
        <button class="lang-option" id="langCn" onclick="switchLang('cn')">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z" />
            </svg>
            ä¸­æ–‡
        </button>
        <button class="lang-option" id="langEn" onclick="switchLang('en')">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z" />
            </svg>
            English
        </button>
    </div>
</div>

<!-- å¼•å…¥é€šç”¨è¯­è¨€ç»„ä»¶JS -->
<script src="common/lang-component.js"></script>

<script>
    const userId = localStorage.getItem("userId");
    if(!userId) window.location.href = "login.html";

    async function initDashboard() {
        // 1. åŠ è½½ç”¨æˆ·ä¿¡æ¯ï¼ˆå¤´åƒç­‰ï¼‰
        const userRes = await fetch(`/api/users/${userId}`);
        const user = await userRes.json();
        const username = user.nickname || user.username;

        // åŠ¨æ€æ–‡æœ¬é€‚é…è¯­è¨€ï¼ˆè¯»å–å½“å‰è¯­è¨€çŠ¶æ€ï¼‰
        const currentLang = localStorage.getItem('appLang') || 'cn';
        document.getElementById("headerName").innerText = username;
        document.getElementById("welcomeTitle").innerText = currentLang === 'cn' ? `Hiï¼Œ${username}` : `Hi, ${username}`;

        if(user.avatar) document.getElementById("headerAvatar").src = "/uploads/" + user.avatar;

        // 2. åŠ è½½ç»Ÿè®¡æ•°æ® (æ–°æ¥å£)
        const statsRes = await fetch(`/api/users/${userId}/stats`);
        const stats = await statsRes.json();

        document.getElementById("tweetCount").innerText = stats.tweetCount;
        document.getElementById("followerCount").innerText = stats.followerCount;
        document.getElementById("followingCount").innerText = stats.followingCount;
    }

    function logout() {
        localStorage.clear();
        // é€€å‡ºåè·³è½¬ç™»å½•é¡µï¼Œé€‚é…è¯­è¨€ï¼ˆç™»å½•é¡µä¼šè¯»å–æœ¬åœ°å­˜å‚¨ï¼Œè¿™é‡Œæ¸…ç©ºåé»˜è®¤ä¸­æ–‡ï¼‰
        window.location.href = "login.html";
    }

    initDashboard();
</script>
</body>
</html>